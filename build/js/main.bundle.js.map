{"version":3,"sources":["webpack://keksobooking/./source/js/utils.js","webpack://keksobooking/./source/js/popup.js","webpack://keksobooking/./source/js/api.js","webpack://keksobooking/./source/js/ad-photos.js","webpack://keksobooking/./source/js/form.js","webpack://keksobooking/./source/js/ad-card.js","webpack://keksobooking/./source/js/filter.js","webpack://keksobooking/./source/js/map.js","webpack://keksobooking/./source/js/main.js"],"names":["declOfNum","number","words","isEscEvent","evt","key","errorTemplate","document","querySelector","content","successTemplate","errorPopup","cloneNode","errorButton","successPopup","showErrorPopup","message","onPopupEscKeydown","preventDefault","remove","removeEventListener","onErrorButtonClick","isEnterEvent","body","append","textContent","addEventListener","getData","onSuccess","onFail","fetch","then","response","ok","json","status","statusText","adData","catch","avatarFileChooser","avatarPreview","photoFileChooser","photoPreview","FILE_TYPES","file","files","fileName","name","toLowerCase","some","it","endsWith","reader","FileReader","src","result","readAsDataURL","innerHTML","newPhoto","appendChild","createElement","width","offsetWidth","height","offsetHeight","resetImagePreview","MIN_PRICE","bungalow","flat","house","palace","NUMBER_OF_QUESTS","1","2","3","100","typeField","priceField","timeField","timeInField","timeOutField","adForm","mapFilter","formFields","querySelectorAll","mapFields","addressField","titleField","roomsField","guestOptions","resetButton","changeMinPrice","currentMinPrice","value","setAttribute","target","valueLength","length","setCustomValidity","reportValidity","priceValue","changeNumberOfGuests","forEach","option","includes","Number","disabled","selected","reset","resetMainMarker","addAdPinsIntoMap","onSuccessSubmit","showSuccessPopup","onFailSubmit","TYPES","ROOMS_WORDS","QUEST_WORDS","adTemplate","typeFilter","priceFilter","roomsFilter","guestsFilter","featuresFilter","filterAdData","offer","type","filterTypes","price","filterPrice","rooms","filterRooms","guests","filterGuests","checkedFeatures","map","feature","every","features","filterFeatures","startCoordinates","lat","lng","mainPinImage","url","size","anchor","pinImage","pinMarkers","field","classList","add","L","on","setView","tileLayer","attribution","addTo","mainPinIcon","icon","iconUrl","iconSize","iconAnchor","fillAdressField","coordinates","toFixed","mainPinMarker","setLatLng","marker","draggable","currentCoordinates","getLatLng","pin","slice","filter","ad","pinIcon","pinMarker","location","bindPopup","adCard","container","title","address","checkin","checkout","description","author","avatar","element","newFeature","photos","adPhoto","renderPhotosIntoContainer","renderAdCard","keepInView","push","cb","_","debounce","FormData","method"],"mappings":"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","file":"main.bundle.js","sourcesContent":["const getRandomIntInclusive = (min, max) => {\n  if (max <= min || min < 0 || max < 0) {\n    throw new Error('Задан неверный диапазон');\n  }\n  min = Math.ceil(min);\n  max = Math.floor(max);\n  return Math.floor(Math.random() * (max - min + 1)) + min;\n};\n\nconst getRandomFloat = (min, max, numbers) => {\n  if (max <= min || min < 0 || max < 0) {\n    throw new Error('Задан неверный диапазон');\n  }\n  if (numbers === undefined || numbers < 0) {\n    numbers = 0;\n  }\n  return (Math.random() * (max - min) + min).toFixed(numbers);\n};\n\nconst getRandomArrayElement = (elements) => {\n  return elements[getRandomIntInclusive(0, elements.length - 1)];\n};\n\nconst shuffleArray = (elements) => {\n  const shuffleElements = elements.slice();\n  for (let i = shuffleElements.length - 1; i > 0; i--) {\n    const j = Math.floor(Math.random() * (i + 1));\n    [shuffleElements[i], shuffleElements[j]] = [shuffleElements[j], shuffleElements[i]];\n  }\n  return shuffleElements;\n};\n\nconst getRandomArray = (elements) => {\n  return shuffleArray(elements).slice(getRandomIntInclusive(0, elements.length - 1));\n};\n\nconst declOfNum = (number, words) => {\n  return words[(number % 100 > 4 && number % 100 < 20) ? 2 : [2, 0, 1, 1, 1, 2][(number % 10 < 5) ? number % 10 : 5]];\n};\n\nconst isEscEvent = (evt) => {\n  return evt.key === 'Escape' || evt.key === 'Esc';\n};\n\nconst isEnterEvent = (evt) => {\n  return evt.key === 'Enter';\n};\n\nexport { \n  getRandomIntInclusive, \n  getRandomFloat, \n  getRandomArrayElement, \n  getRandomArray,\n  declOfNum,\n  isEscEvent,\n  isEnterEvent\n};","import {isEscEvent, isEnterEvent} from './utils.js';\n\nconst errorTemplate = document.querySelector('#error').content.querySelector('.error');\nconst successTemplate = document.querySelector('#success').content.querySelector('.success');\nconst errorPopup = errorTemplate.cloneNode('true');\nconst errorButton = errorPopup.querySelector('.error__button')\nconst successPopup = successTemplate.cloneNode('true');\n\nconst showErrorPopup = (message) => {\n  const onPopupEscKeydown = (evt) => {\n    if (isEscEvent(evt)) {\n      evt.preventDefault();\n      errorPopup.remove();\n      document.removeEventListener('keydown', onPopupEscKeydown);\n    }\n  };\n\n  const onErrorButtonClick = (evt) => {\n    if (isEnterEvent(evt)) {\n      evt.preventDefault();\n      errorPopup.remove();\n      document.removeEventListener('keydown', onErrorButtonClick);\n    }\n  };\n\n  const onPopupClick = () => {\n    errorPopup.remove();\n  };\n\n  document.body.append(errorPopup);\n  errorPopup.querySelector('p').textContent = message;\n  document.addEventListener('keydown', onPopupEscKeydown);\n  errorPopup.addEventListener('click', onPopupClick);\n  errorButton.addEventListener('keydown', onErrorButtonClick);\n};\n\nconst showSuccessPopup = (message) => {\n  const onPopupEscKeydown = (evt) => {\n    if (isEscEvent(evt)) {\n      evt.preventDefault();\n      successPopup.remove();\n      document.removeEventListener('keydown', onPopupEscKeydown);\n    }\n  };\n\n  const onPopupClick = () => {\n    successPopup.remove();\n  };\n\n  document.body.append(successPopup);\n  successPopup.querySelector('p').textContent = message;\n  document.addEventListener('keydown', onPopupEscKeydown);\n  successPopup.addEventListener('click', onPopupClick);\n};\n\nexport { \n  showErrorPopup,\n  showSuccessPopup\n};","const URL_SERVER_GET = 'https://22.javascript.pages.academy/keksobooking/data';\nconst URL_SERVER_POST = 'https://22.javascript.pages.academy/keksobooking';\n\nconst getData = (onSuccess, onFail) => {\n  fetch(URL_SERVER_GET)\n    .then((response) => {\n      if (response.ok) {\n        return response.json();\n      }\n      onFail(`${response.status}: ${response.statusText}`);\n    })\n    .then((adData) => {\n      onSuccess(adData);\n    })\n    .catch(() => onFail('Не удалось получить данные.'));\n};\n\nconst sendData = (onSuccess, onFail, body) => {\n  fetch(\n    URL_SERVER_POST,\n    {\n      method: 'POST',\n      body,\n    },\n  )\n    .then((response) => {\n      if (response.ok) {\n        onSuccess();\n      } else {\n        onFail();\n      }\n    })\n    .catch(() => {\n      onFail();\n    });\n};\n\nexport { \n  getData,\n  sendData\n};","const avatarFileChooser = document.querySelector('.ad-form-header__input');\nconst avatarPreview = document.querySelector('.ad-form-header__preview img');\nconst photoFileChooser = document.querySelector('.ad-form__input');\nconst photoPreview = document.querySelector('.ad-form__photo');\n\nconst FILE_TYPES = ['gif', 'jpg', 'jpeg', 'png'];\nconst AVATAR_DEFAULT_SRC = 'img/muffin-grey.svg';\n\navatarFileChooser.addEventListener('change', () => {\n  const file = avatarFileChooser.files[0];\n  const fileName = file.name.toLowerCase();\n    \n  const matches = FILE_TYPES.some((it) => {\n    return fileName.endsWith(it);\n  });\n    \n  if (matches) {\n    const reader = new FileReader();\n      \n    reader.addEventListener('load', () => {\n      avatarPreview.src = reader.result;\n    });\n      \n    reader.readAsDataURL(file);\n  }\n});\n\nphotoFileChooser.addEventListener('change', () => {\n  const file = photoFileChooser.files[0];\n  const fileName = file.name.toLowerCase();\n    \n  const matches = FILE_TYPES.some((it) => {\n    return fileName.endsWith(it);\n  });\n    \n  if (matches) {\n    const reader = new FileReader();\n      \n    reader.addEventListener('load', () => {\n      photoPreview.innerHTML = '';\n      const newPhoto = photoPreview.appendChild(document.createElement('img'));\n      newPhoto.width = photoPreview.offsetWidth;\n      newPhoto.height = photoPreview.offsetHeight;\n      newPhoto.src = reader.result;\n    });\n      \n    reader.readAsDataURL(file);\n  }\n});\n\nconst resetImagePreview = () => {\n  avatarPreview.src = AVATAR_DEFAULT_SRC;\n  photoPreview.innerHTML = '';\n};\n\nexport { resetImagePreview };","import { showErrorPopup, showSuccessPopup } from './popup.js';\nimport { addAdPinsIntoMap, resetMainMarker } from './map.js';\nimport { getData, sendData } from './api.js';\nimport { resetImagePreview } from './ad-photos.js';\n\nconst MIN_PRICE = {\n  bungalow: 0,\n  flat: 1000,\n  house: 5000,\n  palace: 10000,\n};\nconst MAX_PRICE = 1000000;\nconst MIN_TITLE_LENGTH = 30;\nconst MAX_TITLE_LENGTH = 100;\nconst NUMBER_OF_QUESTS = {\n  1: [1],\n  2: [1, 2],\n  3: [1, 2, 3],\n  100: [0],\n};\n\nconst typeField = document.querySelector('#type');\nconst priceField = document.querySelector('#price');\nconst timeField = document.querySelector('.ad-form__element--time');\nconst timeInField = document.querySelector('#timein');\nconst timeOutField = document.querySelector('#timeout');\nconst adForm = document.querySelector('.ad-form');\nconst mapFilter = document.querySelector('.map__filters');\nconst formFields = document.querySelectorAll('fieldset');\nconst mapFields = document.querySelectorAll('.map__filter');\nconst addressField = document.querySelector('#address');\nconst titleField = document.querySelector('#title');\nconst roomsField = document.querySelector('#room_number');\nconst capacityField = document.querySelector('#capacity');\nconst guestOptions = capacityField.querySelectorAll('option');\nconst resetButton = adForm.querySelector('.ad-form__reset');\n\nconst changeMinPrice = () => {\n  const currentMinPrice = MIN_PRICE[typeField.value];\n  priceField.setAttribute('placeholder', currentMinPrice);\n  priceField.setAttribute('min', currentMinPrice);\n};\n\ntypeField.addEventListener('change', changeMinPrice);\n\ntimeField.addEventListener ('change', (evt) => {\n  timeInField.value = evt.target.value;\n  timeOutField.value = evt.target.value;\n});\n\ntitleField.addEventListener('input', () => {\n  const valueLength = titleField.value.length;\n\n  if (valueLength < MIN_TITLE_LENGTH) {\n    titleField.setCustomValidity('Ещё ' + (MIN_TITLE_LENGTH - valueLength) +' симв.');\n  } else if (valueLength > MAX_TITLE_LENGTH) {\n    titleField.setCustomValidity('Удалите лишние ' + (valueLength - MAX_TITLE_LENGTH) +' симв.');\n  } else {\n    titleField.setCustomValidity('');\n  }\n\n  titleField.reportValidity();\n});\n\npriceField.addEventListener('input', () => {\n  const priceValue = priceField.value;\n\n  if (priceValue < MIN_PRICE[typeField.value]) {\n    priceField.setCustomValidity(`Минимальная цена - ${MIN_PRICE[typeField.value]}`);\n  } else if (priceValue > MAX_PRICE) {\n    priceField.setCustomValidity(`Максимальная цена - ${MAX_PRICE}`);\n  } else {\n    priceField.setCustomValidity('');\n  }\n\n  priceField.reportValidity();\n});\n\nconst changeNumberOfGuests = () => {\n  guestOptions.forEach((option) => {\n    if (NUMBER_OF_QUESTS[roomsField.value].includes(Number(option.value))) {\n      option.disabled = false;\n      option.selected = true;\n    } else {\n      option.disabled = true;\n    }\n  });\n}\n\nroomsField.addEventListener('change', changeNumberOfGuests);\n\nconst disableForms = () => {\n  formFields.forEach((field) => {\n    field.disabled = true;\n  });\n\n  mapFields.forEach((field) => {\n    field.disabled = true;\n  });\n\n  adForm.classList.add('ad-form--disabled');\n  mapFilter.classList.add('map__filters--disabled');\n};\n\nconst enableForms = () => {\n  formFields.forEach((field) => {\n    field.disabled = false;\n  });\n\n  mapFields.forEach((field) => {\n    field.disabled = false;\n  });\n\n  adForm.classList.remove('ad-form--disabled');\n  mapFilter.classList.remove('map__filters--disabled');\n  changeNumberOfGuests();\n};\n\nresetButton.addEventListener ('click', (evt) => {\n  evt.preventDefault();\n  adForm.reset();\n  mapFilter.reset();\n  changeMinPrice();\n  changeNumberOfGuests();\n  resetMainMarker();\n  resetImagePreview();\n  getData((adData) => {\n    addAdPinsIntoMap(adData);\n  }, showErrorPopup);\n});\n\nconst onSuccessSubmit = () => {\n  showSuccessPopup('Форма отправлена!');\n  adForm.reset();\n  mapFilter.reset();\n  changeMinPrice();\n  changeNumberOfGuests();\n  resetMainMarker();\n  resetImagePreview();\n  getData((adData) => {\n    addAdPinsIntoMap(adData);\n  }, showErrorPopup);\n};\n\nconst onFailSubmit = () => {\n  showErrorPopup('Не удалось отправить форму. Попробуйте ещё раз.');\n};\n\nconst setFormSubmit = () => {\n  adForm.addEventListener('submit', (evt) => {\n    evt.preventDefault();\n    sendData(\n      onSuccessSubmit,\n      onFailSubmit,\n      new FormData(evt.target),\n    );\n  });\n};\n\nconst setMapFilterChange = (cb) => {\n  mapFilter.addEventListener('change', cb);\n};\n\nexport { \n  disableForms, \n  enableForms,\n  addressField,\n  setFormSubmit,\n  mapFilter,\n  setMapFilterChange\n};","import { declOfNum } from './utils.js';\n\nconst TYPES = {\n  flat: 'Квартира',\n  bungalow: 'Бунгало',\n  house: 'Дом',\n  palace: 'Дворец',\n};\n\nconst ROOMS_WORDS = [\n  'комната',\n  'комнаты',\n  'комнат',\n];\n\nconst QUEST_WORDS = [\n  'гостя',\n  'гостей',\n  'гостей',\n];\n\nconst adTemplate = document.querySelector('#card').content.querySelector('.popup');\n\nconst renderFeaturesIntoContainer = (container, features) => {\n  container.innerHTML = '';\n\n  features.forEach((element) => {\n    const newFeature = document.createElement('li');\n    newFeature.classList.add('popup__feature', `popup__feature--${element}`);\n    container.appendChild(newFeature);\n  });\n};\n\nconst renderPhotosIntoContainer = (container, photos) => {\n  const adPhoto = container.querySelector('.popup__photo');\n  container.innerHTML = '';\n\n  photos.forEach((element) => {\n    const newPhoto = adPhoto.cloneNode('true');\n    newPhoto.src = element;\n    container.appendChild(newPhoto);\n  });\n};\n\nconst renderAdCard = (adData) => {\n  const adCard = adTemplate.cloneNode('true');\n  adCard.querySelector('.popup__title').textContent = adData.offer.title;\n  adCard.querySelector('.popup__text--address').textContent = adData.offer.address;\n  adCard.querySelector('.popup__text--price').textContent = `${adData.offer.price} ₽/ночь`;\n  adCard.querySelector('.popup__type').textContent = TYPES[adData.offer.type];\n  adCard.querySelector('.popup__text--capacity').textContent = `${adData.offer.rooms} ${declOfNum(adData.offer.rooms, ROOMS_WORDS)} для ${adData.offer.guests} ${declOfNum(adData.offer.guests, QUEST_WORDS)}`;\n  adCard.querySelector('.popup__text--time').textContent = `Заезд после ${adData.offer.checkin}, выезд до ${adData.offer.checkout}`;\n  adCard.querySelector('.popup__description').textContent = adData.offer.description;\n  adCard.querySelector('.popup__avatar').src = adData.author.avatar;\n  renderFeaturesIntoContainer(adCard.querySelector('.popup__features'), adData.offer.features);\n  renderPhotosIntoContainer(adCard.querySelector('.popup__photos'), adData.offer.photos);\n  return adCard;\n};\n\nexport { renderAdCard };","import { mapFilter } from './form.js';\n\nconst LOW_PRICE = 10000;\nconst HIGH_PRICE = 50000;\n\nconst typeFilter = mapFilter.querySelector('#housing-type');\nconst priceFilter = mapFilter.querySelector('#housing-price');\nconst roomsFilter = mapFilter.querySelector('#housing-rooms');\nconst guestsFilter = mapFilter.querySelector('#housing-guests');\nconst featuresFilter = mapFilter.querySelector('#housing-features');\n\nconst filterTypes = (adData) => {\n  if (typeFilter.value === 'any') {\n    return true;\n  }\n  return adData.offer.type === typeFilter.value;\n};\n\nconst filterPrice = (adData) => {\n  switch (priceFilter.value) {\n    case 'any':\n      return true;\n    case 'low':\n      return adData.offer.price < LOW_PRICE;\n    case 'middle':\n      return adData.offer.price >= LOW_PRICE && adData.offer.price < HIGH_PRICE;\n    case 'high':\n      return adData.offer.price >= HIGH_PRICE;\n    default:\n      return false;\n  }\n};\n\nconst filterRooms = (adData) => {\n  if (roomsFilter.value === 'any') {\n    return true;\n  }\n  return adData.offer.rooms === Number(roomsFilter.value);\n};\n\nconst filterGuests = (adData) => {\n  if (guestsFilter.value === 'any') {\n    return true;\n  }\n  return adData.offer.guests === Number(guestsFilter.value);\n};\n\nconst filterFeatures = (adData) => {\n  const checkedFeatures = [...featuresFilter.querySelectorAll('input:checked')].map((feature) => feature.value);\n\n  if (!checkedFeatures.length) {\n    return true;\n  }\n  return checkedFeatures.every((feature) => adData.offer.features.includes(feature));\n}\n\nconst filterAdData = (adData) => {\n  return filterTypes(adData) && filterPrice(adData) && filterRooms(adData) && filterGuests(adData) && filterFeatures(adData);\n};\n\nexport { filterAdData };","/* global L:readonly */\nimport { disableForms, enableForms, addressField } from './form.js';\nimport { renderAdCard } from './ad-card.js';\nimport { filterAdData } from './filter.js';\n\nconst START_ZOOM = 13;\nconst MAX_NUMBER_OF_ADS = 10;\nconst startCoordinates = {\n  lat: 35.6895000,\n  lng: 139.6917100,\n};\nconst mainPinImage = {\n  url: '../img/main-pin.svg',\n  size: [52, 52],\n  anchor: [26, 52],\n};\nconst pinImage = {\n  url: '../img/pin.svg',\n  size: [40, 40],\n  anchor: [20, 40],\n};\nlet pinMarkers = [];\n\ndisableForms();\n\nconst map = L.map('map-canvas')\n  .on('load', enableForms)\n  .setView(startCoordinates, START_ZOOM);\n\nL.tileLayer(\n  'https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png',\n  {\n    attribution: '&copy; <a href=\"https://www.openstreetmap.org/copyright\">OpenStreetMap</a> contributors',\n  },\n).addTo(map);\n\nconst mainPinIcon = L.icon({\n  iconUrl: mainPinImage.url,\n  iconSize: mainPinImage.size,\n  iconAnchor: mainPinImage.anchor,\n});\n\nconst fillAdressField = (coordinates) => {\n  addressField.value = `${coordinates.lat.toFixed(5)}, ${coordinates.lng.toFixed(5)}`;\n};\n\nconst onMovingPin = () => {\n  const currentCoordinates = mainPinMarker.getLatLng();\n  fillAdressField(currentCoordinates);\n};\n\nconst clearPinMarkes = (pins) => {\n  pins.forEach((pin) => {\n    pin.remove();\n  });\n};\n\nconst resetMainMarker = () => {\n  mainPinMarker.setLatLng(startCoordinates);\n  fillAdressField(startCoordinates);\n};\n\naddressField.setAttribute('readonly', true);\nfillAdressField(startCoordinates);\n\nconst mainPinMarker = L.marker(\n  startCoordinates,\n  {\n    draggable: true,\n    icon: mainPinIcon,\n  },\n);\n\nmainPinMarker\n  .on('move', onMovingPin)\n  .addTo(map);\n\nconst addAdPinsIntoMap = (adData) => {\n  clearPinMarkes(pinMarkers);\n  adData\n    .slice(0, MAX_NUMBER_OF_ADS)\n    .filter(filterAdData)\n    .forEach((ad) => {\n      const pinIcon = L.icon({\n        iconUrl: pinImage.url,\n        iconSize: pinImage.size,\n        iconAnchor: pinImage.anchor,\n      });\n\n      const pinMarker = L.marker(\n        {\n          lat: ad.location.lat,\n          lng: ad.location.lng,\n        }, \n        {\n          icon: pinIcon,\n        },\n      );\n      pinMarker\n        .addTo(map)\n        .bindPopup(renderAdCard(ad), {keepInView: true});\n      pinMarkers.push(pinMarker);\n    });\n};\n\nexport { \n  addAdPinsIntoMap,\n  resetMainMarker\n};","/* global _:readonly */\nimport { addAdPinsIntoMap } from './map.js';\nimport { getData } from './api.js';\nimport { showErrorPopup } from './popup.js';\nimport { setFormSubmit, setMapFilterChange } from './form.js';\n\nconst RENDER_DELAY = 500;\n\ngetData(\n  (adData) => {\n    addAdPinsIntoMap(adData);\n    setMapFilterChange(_.debounce(() => addAdPinsIntoMap(adData), RENDER_DELAY));\n  },\n  showErrorPopup);\n\nsetFormSubmit();"],"sourceRoot":""}